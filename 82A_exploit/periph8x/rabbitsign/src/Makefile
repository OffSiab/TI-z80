prefix = /usr/local
exec_prefix = ${prefix}
datarootdir = ${prefix}/share
bindir = ${exec_prefix}/bin
datadir = ${datarootdir}
mandir = ${datarootdir}/man
app_key_dir = ${datadir}/rabbitsign

AR = ar
CC = gcc
CFLAGS = -g -O2 -W -Wall -Wwrite-strings
CPPFLAGS = 
DEFS = -DHAVE_CONFIG_H
GMP_CFLAGS = 
GMP_LIBS = -lgmp
INSTALL = /usr/local/bin/ginstall -c
LDFLAGS = 
LIBS = 
RANLIB = ranlib
SHELL = /bin/sh


srcdir = .


rabbitsign_objects = rabbitsign.o
packxxk_objects = packxxk.o
rskeygen_objects = rskeygen.o
librabbitsign_objects = app8x.o app9x.o apps.o autokey.o cmdline.o error.o graphlink.o header.o input.o keys.o mem.o os8x.o output.o output8x.o output9x.o program.o rabin.o rsa.o typestr.o md5.o 

all: rabbitsign packxxk rskeygen

.PHONY: all clean install install-rskeygen uninstall


rabbitsign: $(rabbitsign_objects) librabbitsign.a
	$(CC) $(CFLAGS) $(LDFLAGS) $(rabbitsign_objects) -L. -lrabbitsign $(GMP_LIBS) $(LIBS) -o rabbitsign

packxxk: $(packxxk_objects) librabbitsign.a
	$(CC) $(CFLAGS) $(LDFLAGS) $(packxxk_objects) -L. -lrabbitsign $(GMP_LIBS) $(LIBS) -o packxxk

rskeygen: $(rskeygen_objects)
	$(CC) $(CFLAGS) $(LDFLAGS) $(rskeygen_objects) $(GMP_LIBS) $(LIBS) -o rskeygen

librabbitsign.a: $(librabbitsign_objects)
	$(AR) cru librabbitsign.a $(librabbitsign_objects)
	$(RANLIB) librabbitsign.a


rabbitsign.o: rabbitsign.c rabbitsign.h internal.h mpz.h ../config.h
	$(CC) -I.. -I$(srcdir) $(GMP_CFLAGS) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/rabbitsign.c

packxxk.o: packxxk.c rabbitsign.h internal.h mpz.h ../config.h
	$(CC) -I.. -I$(srcdir) $(GMP_CFLAGS) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/packxxk.c

rskeygen.o: rskeygen.c ../config.h
	$(CC) -I.. -I$(srcdir) $(GMP_CFLAGS) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/rskeygen.c


app8x.o: app8x.c rabbitsign.h internal.h mpz.h ../config.h
	$(CC) -I.. -I$(srcdir) $(GMP_CFLAGS) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/app8x.c

app9x.o: app9x.c rabbitsign.h internal.h mpz.h ../config.h
	$(CC) -I.. -I$(srcdir) $(GMP_CFLAGS) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/app9x.c

apps.o: apps.c rabbitsign.h internal.h mpz.h ../config.h
	$(CC) -I.. -I$(srcdir) $(GMP_CFLAGS) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/apps.c

autokey.o: autokey.c rabbitsign.h internal.h autokeys.h mpz.h ../config.h
	$(CC) -I.. -I$(srcdir) $(GMP_CFLAGS) $(CFLAGS) $(CPPFLAGS) $(DEFS) -DSHARE_DIR=\"$(app_key_dir)/\" -c $(srcdir)/autokey.c

cmdline.o: cmdline.c rabbitsign.h internal.h mpz.h ../config.h
	$(CC) -I.. -I$(srcdir) $(GMP_CFLAGS) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/cmdline.c

error.o: error.c rabbitsign.h internal.h mpz.h ../config.h
	$(CC) -I.. -I$(srcdir) $(GMP_CFLAGS) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/error.c

graphlink.o: graphlink.c rabbitsign.h internal.h mpz.h ../config.h
	$(CC) -I.. -I$(srcdir) $(GMP_CFLAGS) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/graphlink.c

header.o: header.c rabbitsign.h internal.h mpz.h ../config.h
	$(CC) -I.. -I$(srcdir) $(GMP_CFLAGS) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/header.c

input.o: input.c rabbitsign.h internal.h mpz.h ../config.h
	$(CC) -I.. -I$(srcdir) $(GMP_CFLAGS) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/input.c

keys.o: keys.c rabbitsign.h internal.h mpz.h ../config.h
	$(CC) -I.. -I$(srcdir) $(GMP_CFLAGS) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/keys.c

mem.o: mem.c rabbitsign.h internal.h mpz.h ../config.h
	$(CC) -I.. -I$(srcdir) $(GMP_CFLAGS) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/mem.c

os8x.o: os8x.c rabbitsign.h internal.h mpz.h ../config.h
	$(CC) -I.. -I$(srcdir) $(GMP_CFLAGS) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/os8x.c

output.o: output.c rabbitsign.h internal.h mpz.h ../config.h
	$(CC) -I.. -I$(srcdir) $(GMP_CFLAGS) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/output.c

output8x.o: output8x.c rabbitsign.h internal.h mpz.h ../config.h
	$(CC) -I.. -I$(srcdir) $(GMP_CFLAGS) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/output8x.c

output9x.o: output9x.c rabbitsign.h internal.h mpz.h ../config.h
	$(CC) -I.. -I$(srcdir) $(GMP_CFLAGS) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/output9x.c

program.o: program.c rabbitsign.h internal.h mpz.h ../config.h
	$(CC) -I.. -I$(srcdir) $(GMP_CFLAGS) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/program.c

rabin.o: rabin.c rabbitsign.h internal.h mpz.h ../config.h
	$(CC) -I.. -I$(srcdir) $(GMP_CFLAGS) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/rabin.c

rsa.o: rsa.c rabbitsign.h internal.h mpz.h ../config.h
	$(CC) -I.. -I$(srcdir) $(GMP_CFLAGS) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/rsa.c

typestr.o: typestr.c rabbitsign.h internal.h mpz.h ../config.h
	$(CC) -I.. -I$(srcdir) $(GMP_CFLAGS) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/typestr.c


md5.o: md5.c md5.h ../config.h
	$(CC) -I.. -I$(srcdir) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/md5.c

mpz.o: mpz.c mpz.h ../config.h
	$(CC) -I.. -I$(srcdir) $(CFLAGS) $(CPPFLAGS) $(DEFS) -c $(srcdir)/mpz.c


clean:
	rm -f rabbitsign
	rm -f packxxk
	rm -f rskeygen
	rm -f librabbitsign.a
	rm -f *.o

install: rabbitsign packxxk install-rskeygen
	$(INSTALL) -d -m 755 $(DESTDIR)$(bindir)
	$(INSTALL) -m 755 rabbitsign $(DESTDIR)$(bindir)
	$(INSTALL) -m 755 packxxk $(DESTDIR)$(bindir)

install-rskeygen: rskeygen
	$(INSTALL) -d -m 755 $(DESTDIR)$(bindir)
	$(INSTALL) -m 755 rskeygen $(DESTDIR)$(bindir)

uninstall:
	rm -f $(DESTDIR)$(bindir)/rabbitsign
	rm -f $(DESTDIR)$(bindir)/packxxk
	rm -f $(DESTDIR)$(bindir)/rskeygen
